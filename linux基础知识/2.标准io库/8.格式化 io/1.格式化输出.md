格式化输出函数是 C 语言标准库提供的一组函数，用于以指定格式输出或存储数据。它们可以根据用户定义的格式控制字符串，将数据格式化输出到不同的目标（如标准输出、文件或缓冲区）。这里简要说明这五个函数的区别和用法：

1. **printf()** - 输出到标准输出（通常是终端）。

   - 调用示例：`printf("Hello World!\n");`
   - 成功时返回打印字符数，失败时返回负值。
2. **fprintf()** - 输出到指定文件流。

   - 使用 `FILE *` 指针指定目标文件，例如将数据输出到标准错误 `stderr`。
   - 示例：`fprintf(stderr, "Hello World!\n");`
3. **dprintf()** - 输出到指定文件描述符（`fd`）。

   - 例如：`dprintf(STDERR_FILENO, "Hello World!\n");`
4. **sprintf()** - 输出到指定缓冲区。

   - 格式化后写入字符缓冲区 `buf`，需注意可能的缓冲区溢出风险。
   - 示例：`char buf[20]; sprintf(buf, "%d", 100);`
5. **snprintf()** - 输出到指定缓冲区，限定写入字节数。

   - 增加 `size` 参数限制写入的最大字节数，避免缓冲区溢出。
   - 示例：`snprintf(buf, sizeof(buf), "%d", 100);`

### 格式控制字符串 `format`

- 格式控制字符串用于指定数据的输出格式，包含普通字符（直接输出）和转换说明（以 `%` 开头）。
- 转换说明格式：`%[flags][width][.precision][length]type`。
  - **flags**：如 `#`, `0`, `-`, `' '`, `+`。
  - **width**：指定最小输出宽度。
  - **precision**：控制数值精度或最小输出字符数。
  - **type**：用于指定数据类型（如 `%d`, `%f`, `%s`, `%x` 等）。

掌握各字段的含义和用法可以灵活控制数据的格式化输出，从而实现精准的数据呈现和存储。

---

### ㈠、type 类型

`type`（类型）是格式控制字符串的核心部分，是必不可少的组成部分，其他字段都是可选的。`type`用于指定输出数据的类型，使用一个字符表示，其取值如下：


| 字符 | 对应的数据类型 | 含义                                                                     | 示例代码                                 | 输出             |
| ---- | -------------- | ------------------------------------------------------------------------ | ---------------------------------------- | ---------------- |
| d/i  | int            | 输出有符号十进制表示的整数，`i`为旧式写法                                | `printf("%d\n", 123);`                   | `123`            |
| o    | unsigned int   | 输出无符号八进制表示的整数（默认不输出前缀 0，可使用`#` 使其输出前缀 0） | `printf("%o\n", 123);`                   | `173`            |
| u    | unsigned int   | 输出无符号十进制表示的整数                                               | `printf("%u\n", 123);`                   | `123`            |
| x/X  | unsigned int   | 输出无符号十六进制表示的整数，`x` 输出小写字母，`X` 输出大写字母         | `printf("%x\n", 123);`                   | `7b`             |
| f/F  | double         | 输出浮点数，默认保留小数点后 6 位                                        | `printf("%f\n", 520.1314);`              | `520.131400`     |
| e/E  | double         | 使用科学计数法表示浮点数，`e`输出小写，`E`输出大写                       | `printf("%e\n", 520.1314);`              | `5.201314e+02`   |
| g/G  | double         | 根据数值长度选择最短的方式输出                                           | `printf("%g %g\n", 0.000000123, 0.123);` | `1.23e-07 0.123` |
| s    | char *         | 输出字符串                                                               | `printf("%s\n", "Hello World");`         | `Hello World`    |
| p    | void *         | 输出十六进制表示的指针                                                   | `printf("%p\n", "Hello World");`         | `0x400624`       |
| c    | char           | 输出字符类型，输入数字会转换为 ASCII 码对应的字符                        | `printf("%c\n", 64);`                    | `@`              |

---

### ㈡、flags 字段

`flags` 用于规定输出样式，`%` 后可以跟 0 个或多个以下标志：


| 字符 | 名称   | 作用                                                                    |
| ---- | ------ | ----------------------------------------------------------------------- |
| #    | 井号   | 对八进制数增加前缀 0；十六进制数增加前缀 0x 或 0X；浮点数始终包含小数点 |
| 0    | 数字 0 | 在输出数字前面补 0 直到指定的最小宽度                                   |
| -    | 减号   | 左对齐输出                                                              |
| ' '  | 空格   | 输出正数时在前面加一个空格，输出负数时在前面加一个负号-                 |
| +    | 加号   | 输出正数前加`+`，负数前加 `-`，同时指定 `+` 和空格标志时，`+` 优先      |

---

### ㈢、width 字段

`width` 用于指定输出的最小宽度，若不足则按指定的 `flags` 补 0 或空格：


| width | 描述                     | 示例代码                   | 输出     |
| ----- | ------------------------ | -------------------------- | -------- |
| 数字  | 十进制正数               | `printf("%06d", 1000);`    | `001000` |
| *     | 星号，参数列表中指定宽度 | `printf("%0*d", 6, 1000);` | `001000` |

---

### ㈣、precision 精度

`precision` 精度字段以 `.` 开头，后跟一个十进制正数，具体效果如下：


| .precision | 描述                                                                                         | 示例代码                              | 输出    |
| ---------- | -------------------------------------------------------------------------------------------- | ------------------------------------- | ------- |
| 数字       | 对整数表示最小位数，不足补 0，超过不截断；对浮点数表示小数位数；对字符串表示最多输出的字符数 | `printf("%.5s\n", "hello world");`    | `hello` |
| *          | 星号，参数列表中指定精度                                                                     | `printf("%.*s\n", 5, "hello world");` | `hello` |

---

### ㈤、length 长度修饰符

`length` 指明数据类型的长度，以与不同类型兼容：


| type   | length | d、i          | u、o、x、X             | f、F、e、E、g、G | c      | s       | p      |
| ------ | ------ | ------------- | ---------------------- | ---------------- | ------ | ------- | ------ |
| (none) |        | int           | unsigned int           | double           | char   | char *  | void * |
| hh     |        | signed char   | unsigned char          |                  |        |         |        |
| h      |        | short int     | unsigned short int     |                  |        |         |        |
| l      |        | long int      | unsigned long int      |                  | wint_t | wchar_t |        |
| ll     |        | long long int | unsigned long long int |                  |        |         |        |
| L      |        |               |                        | long double      |        |         |        |
| j      |        | intmax_t      | uintmax_t              |                  |        |         |        |
| z      |        | size_t        | ssize_t                |                  |        |         |        |
| t      |        | ptrdiff_t     | ptrdiff_t              |                  |        |         |        |

---

### 示例代码

以下代码展示了 `printf` 的几种格式控制用法：

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

int main(void) {
    char buf[50] = {0};
    printf("%d (%s) %d (%s)\n", 520, "我爱你", 1314, "一生一世");
    fprintf(stdout, "%d (%s) %d (%s)\n", 520, "我爱你", 1314, "一生一世");
    dprintf(STDOUT_FILENO, "%d (%s) %d (%s)\n", 520, "我爱你", 1314, "一生一世");
    sprintf(buf, "%d (%s) %d (%s)\n", 520, "我爱你", 1314, "一生一世");
    printf("%s", buf);
    memset(buf, 0x00, sizeof(buf));
    snprintf(buf, sizeof(buf), "%d (%s) %d (%s)\n", 520, "我爱你", 1314, "一生一世");
    printf("%s", buf);
    exit(0);
}
```

**运行结果**：

```
520 (我爱你) 1314 (一生一世)
520 (我爱你) 1314 (一生一世)
520 (我爱你) 1314 (一生一世)
520 (我爱你) 1314 (一生一世)
520 (我爱你) 1314 (一生一世)
```

---

这样整理后确保所有内容完整且条理清晰，便于查阅和理解。
